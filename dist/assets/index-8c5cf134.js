var pe=Object.defineProperty;var he=(g,u,e)=>u in g?pe(g,u,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[u]=e;var B=(g,u,e)=>(he(g,typeof u!="symbol"?u+"":u,e),e);import{d as Y,i as ve,c as fe,o as ae,a as y,b as T,e as _,w,u as l,F as ge,f as me,Q as ye,n as re,X as we,g as be,r as S,t as ke,h as V,j as A,T as Se,k as c,l as Ce,m as Ie,B as x,p as Re,K as I,q as Te,s as Ee,v as Me,x as Le,C as Ae,y as xe,z as O,A as $,D as z,E as ee,G as te,H as ue,I as Pe,J as De,L as Oe,M as $e,N as Ue,O as Ne,P as We,R as Fe}from"./vendor-918acf18.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const d of r)if(d.type==="childList")for(const s of d.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(r){const d={};return r.integrity&&(d.integrity=r.integrity),r.referrerPolicy&&(d.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?d.credentials="include":r.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function n(r){if(r.ep)return;r.ep=!0;const d=e(r);fetch(r.href,d)}})();const He=Y({__name:"CropperStencil",props:{image:null,coordinates:null,transitions:null,stencilCoordinates:null},emits:["move","move-end","resize","resize-end"],setup(g,{emit:u}){const e=g,n=ve(),r=fe(()=>{const{height:p,width:m,left:C,top:M}=e.stencilCoordinates,P={width:`${m}px`,height:`${p}px`,transform:`translate(${C}px, ${M}px)`,transition:"none"};return e.transitions&&e.transitions.enabled&&(P.transition=`${e.transitions.time}ms ${e.transitions.timingFunction}`),P});function d(p){u("move",p)}function s(){u("move-end")}function b(p){const C=p.shift().left;u("resize",new we({left:C,right:C,top:C,bottom:C},{preserveRatio:!0}))}function a(){u("resize-end")}return ae(()=>{}),(p,m)=>(y(),T("div",{class:"circle_stencil",style:re(l(r))},[_(l(ge),{class:"circle_stencil__handler",onDrag:b,onDragEnd:a},{default:w(()=>[_(l(n))]),_:1}),_(l(ye),{onMove:d,onMoveEnd:s,class:"circle_stencil__crop_area"},{default:w(()=>[_(l(me),{class:"circle_stencil__preview",image:g.image,coordinates:g.coordinates,width:g.stencilCoordinates.width,height:g.stencilCoordinates.height,transitions:g.transitions},null,8,["image","coordinates","width","height","transitions"])]),_:1})],4))}});const qe={class:"cropper_modal__row cropper_modal__row--first"},Ke={class:"cropper_modal__row cropper_modal__row--last"},Be=Y({__name:"CropperModal",props:{avatarDataUrl:null,isModalShow:{type:Boolean}},emits:["passAvatar","closeModal"],setup(g,{emit:u}){const e=g,n=be(),r=S(null),{isModalShow:d}=ke(e),s=S(!1);function b(){const a=r.value.getResult().canvas;a&&(u("passAvatar",a.toDataURL()),u("closeModal"))}return ae(()=>{window.addEventListener("resize",()=>{var p;const a=document.body.clientWidth;(p=document.querySelector(".tiny-modal__box"))==null||p.style.setProperty("left",`calc(${a>=1008?30:a>=641?20:10}vw + .5rem)`)})}),V(d,a=>{s.value=a}),(a,p)=>(y(),A(l(Se),{class:"cropper_modal",modelValue:s.value,"onUpdate:modelValue":p[1]||(p[1]=m=>s.value=m),showHeader:!1},{default:w(()=>[c("div",qe,[c("div",{class:"cropper_modal__close_button",onClick:p[0]||(p[0]=m=>u("closeModal"))},[_(l(n))])]),_(l(Ce),{class:"cropper",ref_key:"cropper_instance",ref:r,src:g.avatarDataUrl,stencilProps:{aspectRatio:1/1},stencilComponent:He},null,8,["src"]),c("div",Ke,[_(l(x),{class:"crop_button",onClick:b,round:""},{default:w(()=>[Ie("Crop")]),_:1})])]),_:1},8,["modelValue"]))}});const ne=(g,u)=>{const e=g.__vccOpts||g;for(const[n,r]of u)e[n]=r;return e},Ve=ne(Be,[["__scopeId","data-v-56731874"]]),de=Re("konva_node",{state:()=>({avatar_node:"",background_node:"",shape_node:{type:"",color:""},is_trigger_add_shape_node:!1,is_trigger_save_image:!1})});function _e(g,u,e,n=""){const r="#393646";switch(g){case"star":return new I.Star({numPoints:5,outerRadius:e,innerRadius:e/2,fill:u,stroke:r,strokeWidth:2,draggable:!0,name:n,offsetX:-e,offsetY:-e});case"heart":return new I.Shape({width:e*2,height:e*2,fill:u,stroke:r,strokeWidth:2,draggable:!0,name:n,sceneFunc:(s,b)=>{const a=e/18;let p=0,m=0,C=0;s.beginPath(),s.translate(e,e/1.05),s.scale(1,-1);for(let M=0;M<20;M+=.25)p=M/Math.PI,m=a*(16*Math.sin(p)**3),C=a*(13*Math.cos(p)-5*Math.cos(2*p)-2*Math.cos(3*p)-Math.cos(4*p)),s.lineTo(m,C);s.closePath(),s.fillStrokeShape(b)}});case"seven":return new I.Text({text:"7",width:e*2,height:e*2,fontSize:e*2,fill:u,stroke:r,strokeWidth:2,draggable:!0,name:n,fontFamily:"sans-serif",align:"center",padding:e/4});case"fire":return new I.Shape({width:e*2,height:e*2,fill:u,stroke:r,strokeWidth:2,draggable:!0,name:n,sceneFunc:(s,b)=>{const a=e*2;s.beginPath(),s.moveTo(a/2,0),s.quadraticCurveTo(a*7/16,a/2,a*3/8,a/2),s.quadraticCurveTo(a*5/16,a/2,a/4,a/4),s.quadraticCurveTo(a/8,a*5/8,a/8,a*3/4),s.quadraticCurveTo(a/8,a*15/16,a/2,a),s.quadraticCurveTo(a*7/8,a*15/16,a*7/8,a*3/4),s.quadraticCurveTo(a*7/8,a*5/8,a*3/4,a/4),s.quadraticCurveTo(a*11/16,a/2,a*5/8,a/2),s.quadraticCurveTo(a*9/16,a/2,a/2,0),s.closePath(),s.fillStrokeShape(b)}});case"moon":return new I.Shape({width:e*2,height:e*2,fill:u,stroke:r,strokeWidth:2,draggable:!0,name:n,sceneFunc:(s,b)=>{const a=Math.sqrt(2)/2,p=e;s.beginPath();for(let m=Math.PI/4;m<=Math.PI*7/4;m+=.1)s.lineTo(p*(1+Math.cos(m)),p*(1-Math.sin(m)));for(let m=Math.PI*3/2;m>=Math.PI/2;m-=.1)s.lineTo((a+1+a*Math.cos(m))*p,p*(1-a*Math.sin(m)));s.closePath(),s.fillStrokeShape(b)}});case"halo":return new I.Ring({outerRadius:e,innerRadius:e/2,fill:u,stroke:r,strokeWidth:2,draggable:!0,name:n,offsetX:-e,offsetY:-e})}return null}const Ye=""+new URL("b1-2da09242.png",import.meta.url).href,Ze=""+new URL("b2-7ec34724.png",import.meta.url).href,Ge=""+new URL("b3-90869771.png",import.meta.url).href,Xe=""+new URL("r1-bb0a56c0.png",import.meta.url).href,je=""+new URL("s1-af5e0d63.jpg",import.meta.url).href,Qe=""+new URL("s2-ec3d0360.jpg",import.meta.url).href,Je=""+new URL("s3-885f8f2a.jpg",import.meta.url).href,se=g=>(Pe("data-v-518b338f"),g=g(),De(),g),ze={class:"aside"},et={class:"aside__container"},tt={class:"upload_button"},at={class:"general_list background_list"},nt=["src"],st=se(()=>c("span",null,"Meta",-1)),ot={class:"upload_button"},lt={class:"general_list avatar_list"},rt=["src"],it=se(()=>c("span",null,"777",-1)),ct={class:"general_list shape_color_list"},ut={class:"general_list shape_list"},dt=["src"],_t={class:"upload_button"},pt={class:"general_list background_list"},ht=["src"],vt=se(()=>c("span",null,"Meta",-1)),ft={class:"upload_button"},gt={class:"general_list avatar_list"},mt=["src"],yt=se(()=>c("span",null,"777",-1)),wt={class:"general_list shape_color_list"},bt={class:"general_list shape_list"},kt=["src"],St={class:"general_list operation_list"},Ct=Y({__name:"MyAside",setup(g){class u{constructor(i,t){B(this,"value");B(this,"index");this.index=i,this.value=t}}class e{constructor(i=[]){B(this,"data");B(this,"counter");this.data=[],this.counter=0,i.length>0&&(this.data=i.map(t=>(this.counter+=1,new u(this.counter,t))))}push(i){this.counter+=1,this.data.push(new u(this.counter,i))}access(i){return this.data[i].value}remove(i){for(let t=0;t<this.data.length;t+=1)if(this.data[t].index===i){this.data.splice(t,1);return}}}const n=de(),r=Te(),d=Ee(),s=Me(),b=Le();let a=!1;const p=S(!1),m=S(["templates"]),C=S("templates"),M=S(!1),P=S(new e([Xe])),W=S(""),U=["#DD5353","#FFD95A","#62CDFF","#03C988","#FFABAB","#9A208C","#20262E","#F0F0F0"],N=["star","heart","seven","fire","moon","halo"].map(v=>({type:v,image:S("")})),H=S(U[0]),Z=S(""),G=[{name:"Save",icon:"SaveIcon",handler:E}],X=[Ye,Ze,Ge,je,Qe,Je],q=S(new e(X));function j(){a?(document.querySelector(".aside").classList.remove("aside--collapsed"),document.querySelector(".collapse_button").classList.remove("collapse_button--reversed"),a=!1):(document.querySelector(".aside").classList.add("aside--collapsed"),document.querySelector(".collapse_button").classList.add("collapse_button--reversed"),a=!0)}function K(v){v.length!=0&&(C.value=v[0])}function oe(v){m.value=[v.name]}function Q(v){if(!v.target)return;const i=v.target;if(i.files&&i.files[0]){const t=new FileReader;t.onload=f=>{f.target&&(q.value.push(f.target.result),i.value="")},t.readAsDataURL(i.files[0])}}function J(v){if(!v.target)return;const i=v.target;if(i.files&&i.files[0]){const t=new FileReader;t.onload=f=>{f.target&&(W.value=f.target.result,i.value="",M.value=!0)},t.readAsDataURL(i.files[0])}}function le(v){P.value.push(v)}function h(){M.value=!1,W.value=""}function o(v){n.background_node=v}function k(v){n.avatar_node=v}function R(v){Z.value=v,n.shape_node={type:Z.value,color:H.value},n.is_trigger_add_shape_node=!0}function E(){n.is_trigger_save_image=!0}function L(){const i=new I.Circle({radius:24,fill:H.value});for(const t of N){let f=_e(t.type,H.value,48);f?t.image.value=f.toDataURL():t.image.value=i.toDataURL()}}function F(v){H.value=v,L()}return ae(()=>{p.value=document.body.clientWidth<=640,window.addEventListener("resize",()=>{const i=document.body.clientWidth;p.value=i<=640}),L()}),(v,i)=>(y(),T("div",ze,[c("div",et,[p.value?(y(),A(l(xe),{key:1,modelValue:C.value,"onUpdate:modelValue":i[1]||(i[1]=t=>C.value=t),onClick:oe},{default:w(()=>[_(l(ee),{title:"Templates",name:"templates"},{default:w(()=>[c("label",_t,[c("input",{type:"file",accept:"image/*",onChange:Q},null,32),_(l(d))]),c("div",pt,[(y(!0),T(O,null,$(q.value.data,(t,f)=>(y(),A(l(x),{class:"general_list__item background_list__item",key:f,onClick:D=>o(t.value)},{default:w(()=>[c("img",{src:t.value},null,8,ht),vt]),_:2},1032,["onClick"]))),128))])]),_:1}),_(l(ee),{title:"Avatars",name:"avatars"},{default:w(()=>[c("label",ft,[c("input",{type:"file",accept:"image/*",onChange:J},null,32),_(l(d))]),c("div",gt,[(y(!0),T(O,null,$(P.value.data,(t,f)=>(y(),A(l(x),{class:"general_list__item avatar_list__item",key:f,onClick:D=>k(t.value)},{default:w(()=>[c("img",{src:t.value},null,8,mt),yt,_(l(s))]),_:2},1032,["onClick"]))),128))])]),_:1}),_(l(ee),{title:"Shapes",name:"shapes"},{default:w(()=>[c("div",wt,[(y(),T(O,null,$(U,(t,f)=>_(l(x),{class:"general_list__item shape_color_list__item",circle:"",key:f,onClick:D=>F(t),style:re({backgroundColor:t})},null,8,["onClick","style"])),64))]),c("div",bt,[(y(!0),T(O,null,$(l(N),(t,f)=>(y(),A(l(x),{class:"general_list__item shape_list__item",key:f,onClick:D=>R(t.type)},{default:w(()=>[c("img",{src:t.image.value},null,8,kt),c("span",null,te(t.type.charAt(0).toUpperCase()+t.type.slice(1)),1),_(l(s))]),_:2},1032,["onClick"]))),128))])]),_:1}),_(l(ee),{title:"Operations",name:"operations"},{default:w(()=>[c("div",St,[(y(),T(O,null,$(G,(t,f)=>_(l(x),{class:"general_list__item operation_list__item",key:f,onClick:t.handler},{default:w(()=>[c("span",null,te(t.name),1),(y(),A(ue(t.icon))),_(l(b))]),_:2},1032,["onClick"])),64))])]),_:1})]),_:1},8,["modelValue"])):(y(),A(l(Ae),{key:0,modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=t=>m.value=t),onChange:K},{default:w(()=>[_(l(z),{title:"Templates",name:"templates"},{default:w(()=>[c("label",tt,[c("input",{type:"file",accept:"image/*",onChange:Q},null,32),_(l(d))]),c("div",at,[(y(!0),T(O,null,$(q.value.data,(t,f)=>(y(),A(l(x),{class:"general_list__item background_list__item background_list__item--middle",key:f,onClick:D=>o(t.value)},{default:w(()=>[c("img",{src:t.value},null,8,nt),st]),_:2},1032,["onClick"]))),128))])]),_:1}),_(l(z),{title:"Avatars",name:"avatars"},{default:w(()=>[c("label",ot,[c("input",{type:"file",accept:"image/*",onChange:J},null,32),_(l(d))]),c("div",lt,[(y(!0),T(O,null,$(P.value.data,(t,f)=>(y(),A(l(x),{class:"general_list__item avatar_list__item avatar_list__item--middle",key:f,onClick:D=>k(t.value)},{default:w(()=>[c("img",{src:t.value},null,8,rt),it,_(l(s))]),_:2},1032,["onClick"]))),128))])]),_:1}),_(l(z),{title:"Shapes",name:"shapes"},{default:w(()=>[c("div",ct,[(y(),T(O,null,$(U,(t,f)=>_(l(x),{class:"general_list__item shape_color_list__item",circle:"",key:f,onClick:D=>F(t),style:re({backgroundColor:t})},null,8,["onClick","style"])),64))]),c("div",ut,[(y(!0),T(O,null,$(l(N),(t,f)=>(y(),A(l(x),{class:"general_list__item shape_list__item shape_list__item--middle",key:f,onClick:D=>R(t.type)},{default:w(()=>[c("img",{src:t.image.value},null,8,dt),c("span",null,te(t.type.charAt(0).toUpperCase()+t.type.slice(1)),1),_(l(s))]),_:2},1032,["onClick"]))),128))])]),_:1}),_(l(z),{title:"Operations",name:"operations"},{default:w(()=>[(y(),T(O,null,$(G,(t,f)=>_(l(x),{class:"general_list__item operation_list__item",key:f,onClick:t.handler},{default:w(()=>[c("span",null,te(t.name),1),(y(),A(ue(t.icon))),_(l(b))]),_:2},1032,["onClick"])),64))]),_:1})]),_:1},8,["modelValue"]))]),c("div",{class:"collapse_button",onClick:j},[_(l(r))]),_(Ve,{isModalShow:M.value,avatarDataUrl:W.value,onPassAvatar:le,onCloseModal:h},null,8,["isModalShow","avatarDataUrl"])]))}});const It=ne(Ct,[["__scopeId","data-v-518b338f"]]),Rt={class:"app__container"},Tt=Y({__name:"App",setup(g){return(u,e)=>{const n=Oe("router-view");return y(),T("div",Rt,[c("aside",null,[_(It)]),c("main",null,[_(n)])])}}});const Et=ne(Tt,[["__scopeId","data-v-224933c4"]]);const Mt={id:"stage"},Lt=Y({__name:"Stage",setup(g){class u{constructor(){B(this,"id");this.id=0}get(){return this.id+=1,this.id-1}}const e=de(),n=S(null),r=S(null),d=S(null),s=S(null),b=S(null),a=new u,p=new u,m=new u,C=new window.Image,M="background",P=10;let W=0,U="";function ie(h,o){return Math.sqrt(Math.pow(o.x-h.x,2)+Math.pow(o.y-h.y,2))}function N(){s.value.x(d.value.width()),b.value.x(d.value.width()-P)}function H(h){const o=n.value.getStage(),k=1.2,R=o.getPointerPosition(),E={x:R.x-o.getAbsolutePosition().x,y:R.y-o.getAbsolutePosition().y};let L=!0;h.evt.deltaY<0?n.value.scale({x:n.value.scale().x*k,y:n.value.scale().y*k}):(n.value.scale({x:n.value.scale().x/k,y:n.value.scale().y/k}),L=!1),o.absolutePosition({x:o.getAbsolutePosition().x-E.x*((L?k:1/k)-1),y:o.getAbsolutePosition().y-E.y*((L?k:1/k)-1)}),N()}function Z(h){const o=h.evt.touches[0],k=h.evt.touches[1];if(o&&k){const R=ie({x:o.clientX,y:o.clientY},{x:k.clientX,y:k.clientY}),E=n.value.scale().x*R/W;n.value.scale({x:E,y:E}),W=R,N()}}function G(){W=0}function X(){n.value.width(document.body.offsetWidth),n.value.height(document.body.offsetHeight)}function q(){const h=d.value.getNode(),o=n.value.findOne(`.${U}`);d.value.moveToTop(),o!==h&&(o?d.value.nodes([o]):d.value.nodes([]),N())}function j(h){if(h.target===n.value){U="",q();return}if(h.target.parent&&h.target.parent.className==="Transformer")return;const o=h.target.name();o===M?U="":U=o,q()}function K(){const h=n.value.findOne(`.${U}`);h&&(h.destroy(),d.value.nodes([]))}function oe(h){C.src=h,r.value.draw()}function Q(h){const o=new window.Image;o.src=h;const k=new I.Circle({x:-o.width,y:-o.height,radius:o.width/2,fillPatternImage:o,fillPatternRepeat:"no-repeat",fillPatternOffsetX:o.width/2,fillPatternOffsetY:o.height/2,draggable:!0,name:`avatar_${a.get()}`,offsetX:-o.width/2,offsetY:-o.height/2});r.value.add(k),d.value.nodes([k])}function J(){let o=_e(e.shape_node.type,e.shape_node.color,100,`shape_${p.get()}`);o&&(o.position({x:-100*2,y:-100*2}),r.value.add(o),d.value.nodes([o]))}function le(){const h=n.value.clone(),o=h.getLayers()[0],k=h.findOne("Transformer"),R=document.createElement("a");let E=0,L=0,F=0,v=0;h.scale({x:1,y:1}),k.destroy();for(let i=0;i<o.children.length;i+=1){const t=o.children[i].absolutePosition().x,f=o.children[i].absolutePosition().y,D=o.children[i].absolutePosition().x+o.children[i].width(),ce=o.children[i].absolutePosition().y+o.children[i].height();i===0?(E=t,L=f,F=D,v=ce):(E=Math.min(E,t),L=Math.min(L,f),F=Math.max(F,D),v=Math.max(v,ce))}R.download=`berserk${"7".repeat(m.get()+1)}meta.png`,R.href=h.toDataURL({x:E,y:L,width:F-E,height:v-L}),document.body.appendChild(R),R.click(),document.body.removeChild(R)}return ae(()=>{I.hitOnDragEnabled=!0,n.value=new I.Stage({container:"stage",width:document.body.offsetWidth,height:document.body.offsetHeight,draggable:!0}),r.value=new I.Layer,d.value=new I.Transformer({centeredScaling:!0,keepRatio:!0}),s.value=new I.Circle({y:-50,radius:P,stroke:"#E76161",fill:"white",strokeWidth:1}),b.value=new I.Line({y:-50,points:[0,0,P*2,0],stroke:"#E76161",strokeWidth:1+1}),n.value.on("wheel",H),n.value.on("touchmove",Z),n.value.on("touchend",G),n.value.on("mousedown",j),n.value.on("touchstart",j),d.value.on("transform",()=>{N()}),s.value.on("mouseenter",()=>{n.value.container().style.cursor="pointer"}),s.value.on("mouseleave",()=>{n.value.container().style.cursor="default"}),s.value.on("click",K),s.value.on("touchend",K),b.value.on("mouseenter",()=>{n.value.container().style.cursor="pointer"}),b.value.on("mouseleave",()=>{n.value.container().style.cursor="default"}),b.value.on("click",K),b.value.on("touchend",K),d.value.add(s.value),d.value.add(b.value),r.value.add(new I.Image({image:C,name:M})),r.value.add(d.value),n.value.add(r.value),window.addEventListener("resize",X)}),$e(()=>{window.removeEventListener("resize",X)}),V(()=>e.avatar_node,()=>{e.avatar_node&&e.avatar_node!=""&&(Q(e.avatar_node),e.avatar_node="")}),V(()=>e.is_trigger_add_shape_node,()=>{e.is_trigger_add_shape_node&&(J(),e.is_trigger_add_shape_node=!1)}),V(()=>e.background_node,()=>{e.background_node&&e.background_node!=""&&(oe(e.background_node),e.background_node="")}),V(()=>e.is_trigger_save_image,()=>{e.is_trigger_save_image&&(le(),e.is_trigger_save_image=!1)}),(h,o)=>(y(),T("div",Mt))}});const At=ne(Lt,[["__scopeId","data-v-8fe0886a"]]),xt=[{path:"/",redirect:{name:"Stage"}},{path:"/stage",name:"Stage",component:At},{path:"/:catchAll(.*)",redirect:{name:"Stage"}}],Pt=Ue({history:Ne(),routes:xt}),Dt=We();Fe(Et).use(Pt).use(Dt).mount("#app");
