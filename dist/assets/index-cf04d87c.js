var Pe=Object.defineProperty;var Ae=(f,c,t)=>c in f?Pe(f,c,{enumerable:!0,configurable:!0,writable:!0,value:t}):f[c]=t;var G=(f,c,t)=>(Ae(f,typeof c!="symbol"?c+"":c,t),t);import{K as P,F as Oe,c as De,Q as Ne,X as We,f as Ue}from"./graphic-0052cc62.js";import{i as He,a as Fe,B as D,T as Ve,b as Be,d as qe,e as Ke,f as Ze,h as Ye,j as Ge,k as Xe,C as ce,l as je}from"./ui-be333821.js";import{J as Qe,d as K,c as Je,f as X,l as d,q as C,b as m,A as R,K as u,L as ee,M as T,N as ze,O as B,t as $,s,E as et,P as tt,H as x,I as A,v as at,y as te,w as ye,u as ot,x as nt,Q as Ce,R as ke,S as st,U as lt,V as it}from"./vue-ac31de14.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const _ of i)if(_.type==="childList")for(const l of _.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const _={};return i.integrity&&(_.integrity=i.integrity),i.referrerPolicy&&(_.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?_.credentials="include":i.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function e(i){if(i.ep)return;i.ep=!0;const _=t(i);fetch(i.href,_)}})();const Se=Qe("konva_node",{state:()=>({avatar_node:"",background_node:"",shape_node:{type:"",color:""},is_trigger_add_shape_node:!1,is_trigger_save_image:!1,is_trigger_relocate:!1,is_trigger_change_z_index:!1,is_to_top:!1,is_trigger_change_color:!1,changed_color:""})});function Ie(f,c,t,e=""){const i="#393646";switch(f){case"star":return new P.Star({numPoints:5,outerRadius:t,innerRadius:t/2,fill:c,stroke:i,strokeWidth:2,draggable:!0,name:e,offsetX:-t,offsetY:-t});case"heart":return new P.Shape({width:t*2,height:t*2,fill:c,stroke:i,strokeWidth:2,draggable:!0,name:e,sceneFunc:(l,k)=>{const o=t/18;let g=0,y=0,b=0;l.beginPath(),l.translate(t,t/1.05),l.scale(1,-1);for(let S=0;S<20;S+=.25)g=S/Math.PI,y=o*(16*Math.sin(g)**3),b=o*(13*Math.cos(g)-5*Math.cos(2*g)-2*Math.cos(3*g)-Math.cos(4*g)),l.lineTo(y,b);l.closePath(),l.fillStrokeShape(k)}});case"seven":return new P.Text({text:"7",width:t*2,height:t*2,fontSize:t*2,fill:c,stroke:i,strokeWidth:2,draggable:!0,name:e,fontFamily:"sans-serif",align:"center",padding:t/4});case"fire":return new P.Shape({width:t*2,height:t*2,fill:c,stroke:i,strokeWidth:2,draggable:!0,name:e,sceneFunc:(l,k)=>{const o=t*2;l.beginPath(),l.moveTo(o/2,0),l.quadraticCurveTo(o*7/16,o/2,o*3/8,o/2),l.quadraticCurveTo(o*5/16,o/2,o/4,o/4),l.quadraticCurveTo(o/8,o*5/8,o/8,o*3/4),l.quadraticCurveTo(o/8,o*15/16,o/2,o),l.quadraticCurveTo(o*7/8,o*15/16,o*7/8,o*3/4),l.quadraticCurveTo(o*7/8,o*5/8,o*3/4,o/4),l.quadraticCurveTo(o*11/16,o/2,o*5/8,o/2),l.quadraticCurveTo(o*9/16,o/2,o/2,0),l.closePath(),l.fillStrokeShape(k)}});case"moon":return new P.Shape({width:t*2,height:t*2,fill:c,stroke:i,strokeWidth:2,draggable:!0,name:e,sceneFunc:(l,k)=>{const o=Math.sqrt(2)/2,g=t;l.beginPath();for(let y=Math.PI/4;y<=Math.PI*7/4;y+=.1)l.lineTo(g*(1+Math.cos(y)),g*(1-Math.sin(y)));for(let y=Math.PI*3/2;y>=Math.PI/2;y-=.1)l.lineTo((o+1+o*Math.cos(y))*g,g*(1-o*Math.sin(y)));l.closePath(),l.fillStrokeShape(k)}});case"halo":return new P.Ring({outerRadius:t,innerRadius:t/2,fill:c,stroke:i,strokeWidth:2,draggable:!0,name:e,offsetX:-t,offsetY:-t})}return null}const rt=K({__name:"CropperStencil",props:{image:{},coordinates:{},transitions:{},stencilCoordinates:{}},emits:["move","move-end","resize","resize-end"],setup(f,{emit:c}){const t=f,e=He(),i=Je(()=>{const{height:g,width:y,left:b,top:S}=t.stencilCoordinates,O={width:`${y}px`,height:`${g}px`,transform:`translate(${b}px, ${S}px)`,transition:"none"};return t.transitions&&t.transitions.enabled&&(O.transition=`${t.transitions.time}ms ${t.transitions.timingFunction}`),O});function _(g){c("move",g)}function l(){c("move-end")}function k(g){const b=g.shift().left;c("resize",new We({left:b,right:b,top:b,bottom:b},{preserveRatio:!0}))}function o(){c("resize-end")}return X(()=>{}),(g,y)=>(d(),C("div",{class:"circle_stencil",style:ee(i.value)},[m(u(Oe),{class:"circle_stencil__handler",onDrag:k,onDragEnd:o},{default:R(()=>[m(u(e))]),_:1}),m(u(Ne),{onMove:_,onMoveEnd:l,class:"circle_stencil__crop_area"},{default:R(()=>[m(u(De),{class:"circle_stencil__preview",image:g.image,coordinates:g.coordinates,width:g.stencilCoordinates.width,height:g.stencilCoordinates.height,transitions:g.transitions},null,8,["image","coordinates","width","height","transitions"])]),_:1})],4))}});const ct={class:"cropper_modal__row cropper_modal__row--first"},_t={class:"cropper_modal__row cropper_modal__row--last"},ut=K({__name:"CropperModal",props:{avatarDataUrl:{},isModalShow:{type:Boolean}},emits:["passAvatar","closeModal"],setup(f,{emit:c}){const t=f,e=Fe(),i=T(null),{isModalShow:_}=ze(t),l=T(!1);function k(){const o=i.value.getResult().canvas;o&&(c("passAvatar",o.toDataURL()),c("closeModal"))}return X(()=>{window.addEventListener("resize",()=>{var g;const o=document.body.clientWidth;(g=document.querySelector(".tiny-modal__box"))==null||g.style.setProperty("left",`calc(${o>=1008?30:o>=641?20:10}vw + .5rem)`)})}),B(_,o=>{l.value=o}),(o,g)=>(d(),$(u(Ve),{class:"cropper_modal",modelValue:l.value,"onUpdate:modelValue":g[1]||(g[1]=y=>l.value=y),showHeader:!1},{default:R(()=>[s("div",ct,[s("div",{class:"cropper_modal__close_button",onClick:g[0]||(g[0]=y=>c("closeModal"))},[m(u(e))])]),m(u(Ue),{class:"cropper",ref_key:"cropper_instance",ref:i,src:o.avatarDataUrl,stencilProps:{aspectRatio:1/1},stencilComponent:rt},null,8,["src"]),s("div",_t,[m(u(D),{class:"crop_button",onClick:k,round:""},{default:R(()=>[et("Crop")]),_:1})])]),_:1},8,["modelValue"]))}});const j=(f,c)=>{const t=f.__vccOpts||f;for(const[e,i]of c)t[e]=i;return t},dt=j(ut,[["__scopeId","data-v-18737960"]]),ht={class:"my_tabs"},pt={class:"my_tabs__nav"},vt={class:"my_tabs__nav__scroll_bar"},gt=["onClick"],ft={class:"my_tabs__container"},mt=K({__name:"MyTabs",props:{modelValue:{}},emits:["click","update:modelValue"],setup(f,{emit:c}){const t=f,e=tt(),i=e.default?e.default().filter(o=>o.type.__name==="MyTabItem"):[],_=i.map(o=>o.props?o.props.name:""),l=i.map(o=>o.props?o.props.title:"");function k(o){c("click",o),c("update:modelValue",o)}return X(()=>{t.modelValue===""&&(c("click",_[0]),c("update:modelValue",_[0]))}),(o,g)=>(d(),C("div",ht,[s("div",pt,[s("div",vt,[(d(!0),C(x,null,A(u(l),(y,b)=>(d(),C("div",{key:b,class:at(o.modelValue===u(_)[b]?"my_tabs__nav__title my_tabs__nav__title--active":"my_tabs__nav__title"),onClick:S=>k(u(_)[b])},te(y),11,gt))),128))])]),s("div",ft,[(d(!0),C(x,null,A(u(i),(y,b)=>(d(),C(x,{key:b},[o.modelValue===u(_)[b]?(d(),$(ye(y),{key:0})):ot("",!0)],64))),128))])]))}});const yt=j(mt,[["__scopeId","data-v-01c98197"]]),bt={class:"my_tab_item"},wt=K({__name:"MyTabItem",props:{name:{},title:{}},setup(f){return(c,t)=>(d(),C("div",bt,[nt(c.$slots,"default",{},void 0,!0)]))}});const _e=j(wt,[["__scopeId","data-v-a43d6799"]]),Re=""+new URL("b1-17081d0a.png",import.meta.url).href,Te=""+new URL("b2-a3fadbfe.png",import.meta.url).href,Ee=""+new URL("b3-c9265a32.png",import.meta.url).href,Me=""+new URL("r1-1779894b.png",import.meta.url).href,$e=""+new URL("s1-af5e0d63.jpg",import.meta.url).href,xe=""+new URL("s2-ec3d0360.jpg",import.meta.url).href,Le=""+new URL("s3-885f8f2a.jpg",import.meta.url).href,de=f=>(Ce("data-v-3dd92b3f"),f=f(),ke(),f),Ct={class:"aside"},kt={class:"aside__container"},St={class:"upload_button"},It={class:"general_list background_list"},Rt=["src"],Tt=de(()=>s("span",null,"Meta",-1)),Et={class:"upload_button"},Mt={class:"general_list avatar_list"},$t=["src"],xt=de(()=>s("span",null,"777",-1)),Lt={class:"general_list shape_color_list"},Pt={class:"shape_color_list__row"},At={class:"shape_color_list__row"},Ot={class:"general_list shape_list"},Dt=["src"],Nt={class:"upload_button"},Wt={class:"general_list background_list"},Ut=["src"],Ht=de(()=>s("span",null,"Meta",-1)),Ft={class:"upload_button"},Vt={class:"general_list avatar_list"},Bt=["src"],qt=de(()=>s("span",null,"777",-1)),Kt={class:"general_list shape_color_list"},Zt={class:"shape_color_list__row"},Yt={class:"shape_color_list__row"},Gt={class:"general_list shape_list"},Xt=["src"],jt={class:"general_list operation_list"},Qt=K({__name:"MyAside",setup(f){class c{constructor(p,a){G(this,"value");G(this,"index");this.index=p,this.value=a}}class t{constructor(p=[]){G(this,"data");G(this,"counter");this.data=[],this.counter=0,p.length>0&&(this.data=p.map(a=>(this.counter+=1,new c(this.counter,a))))}push(p){this.counter+=1,this.data.push(new c(this.counter,p))}access(p){return this.data[p].value}remove(p){for(let a=0;a<this.data.length;a+=1)if(this.data[a].index===p){this.data.splice(a,1);return}}}const e=Se(),i=Be(),_=qe(),l=Ke(),k=Ze(),o=Ye(),g=Ge(),y=Xe();let b=!1;const S=T(!1),O=T(["templates"]),H=T("templates"),W=T(!1),Q=T(new t([Me])),Z=T(""),U=["#DD5353","#FFD95A","#62CDFF","#03C988","#FFABAB","#9A208C","#20262E","#F0F0F0"],J=["star","heart","seven","fire","moon","halo"].map(h=>({type:h,image:T("")})),Y=T(U[0]),z=T(""),F=[{name:"Save",icon:g,handler:n},{name:"Relocate",icon:y,handler:w},{name:"Move to Top",icon:l,handler:()=>L(!0)},{name:"Move to Bottom",icon:k,handler:()=>L(!1)}],ae=[Re,Te,Ee,$e,xe,Le],V=T(new t(ae));function he(){b?(document.querySelector(".aside").classList.remove("aside--collapsed"),document.querySelector(".collapse_button").classList.remove("collapse_button--reversed"),b=!1):(document.querySelector(".aside").classList.add("aside--collapsed"),document.querySelector(".collapse_button").classList.add("collapse_button--reversed"),b=!0)}function oe(h){h.length!==0&&(H.value=h[0])}function ne(h){O.value=[h]}function se(h){if(!h.target)return;const p=h.target;if(p.files&&p.files[0]){const a=new FileReader;a.onload=v=>{if(!v.target)return;const I=v.target.result;if(!I.startsWith("data:"))return;const N=new Image;N.onload=()=>{V.value.push(I),p.value=""},N.onerror=()=>{console.log("Background image error.")},N.src=I},a.readAsDataURL(p.files[0])}}function le(h){if(!h.target)return;const p=h.target;if(p.files&&p.files[0]){const a=new FileReader;a.onload=v=>{if(!v.target)return;const I=v.target.result;if(!I.startsWith("data:"))return;const N=new Image;N.onload=()=>{Z.value=I,p.value="",W.value=!0},N.onerror=()=>{console.log("Avatar image error.")},N.src=I},a.readAsDataURL(p.files[0])}}function pe(h){Q.value.push(h)}function ve(){W.value=!1,Z.value=""}function ie(h){e.background_node=h}function re(h){e.avatar_node=h}function r(h){z.value=h,e.shape_node={type:z.value,color:Y.value},e.is_trigger_add_shape_node=!0}function n(){e.is_trigger_save_image=!0}function w(){e.is_trigger_relocate=!0}function L(h){e.is_to_top=h,e.is_trigger_change_z_index=!0}function E(){const p=new P.Circle({radius:24,fill:Y.value});for(const a of J){let v=Ie(a.type,Y.value,48);v?a.image.value=v.toDataURL():a.image.value=p.toDataURL()}}function M(h){Y.value=h,E(),e.changed_color=h,e.is_trigger_change_color=!0}return X(()=>{S.value=document.body.clientWidth<=640,window.addEventListener("resize",()=>{const p=document.body.clientWidth;S.value=p<=640}),E()}),(h,p)=>(d(),C("div",Ct,[s("div",kt,[S.value?(d(),$(yt,{key:1,modelValue:H.value,"onUpdate:modelValue":p[1]||(p[1]=a=>H.value=a),onClick:ne},{default:R(()=>[m(_e,{title:"Templates",name:"templates"},{default:R(()=>[s("label",Nt,[s("input",{type:"file",accept:"image/*",onChange:se},null,32),m(u(_))]),s("div",Wt,[(d(!0),C(x,null,A(V.value.data,(a,v)=>(d(),$(u(D),{key:v,class:"general_list__item background_list__item",onClick:I=>ie(a.value)},{default:R(()=>[s("img",{src:a.value},null,8,Ut),Ht]),_:2},1032,["onClick"]))),128))])]),_:1}),m(_e,{title:"Avatars",name:"avatars"},{default:R(()=>[s("label",Ft,[s("input",{type:"file",accept:"image/*",onChange:le},null,32),m(u(_))]),s("div",Vt,[(d(!0),C(x,null,A(Q.value.data,(a,v)=>(d(),$(u(D),{class:"general_list__item avatar_list__item",key:v,onClick:I=>re(a.value)},{default:R(()=>[s("img",{src:a.value},null,8,Bt),qt,m(u(o))]),_:2},1032,["onClick"]))),128))])]),_:1}),m(_e,{title:"Shapes",name:"shapes"},{default:R(()=>[s("div",Kt,[s("div",Zt,[(d(!0),C(x,null,A(U.slice(0,4),(a,v)=>(d(),$(u(D),{class:"general_list__item shape_color_list__item",circle:"",key:v,onClick:I=>M(a),style:ee({backgroundColor:a})},null,8,["onClick","style"]))),128))]),s("div",Yt,[(d(!0),C(x,null,A(U.slice(4),(a,v)=>(d(),$(u(D),{class:"general_list__item shape_color_list__item",circle:"",key:v,onClick:I=>M(a),style:ee({backgroundColor:a})},null,8,["onClick","style"]))),128))])]),s("div",Gt,[(d(!0),C(x,null,A(u(J),(a,v)=>(d(),$(u(D),{class:"general_list__item shape_list__item",key:v,onClick:I=>r(a.type)},{default:R(()=>[s("img",{src:a.image.value},null,8,Xt),s("span",null,te(a.type.charAt(0).toUpperCase()+a.type.slice(1)),1),m(u(o))]),_:2},1032,["onClick"]))),128))])]),_:1}),m(_e,{title:"Operations",name:"operations"},{default:R(()=>[s("div",jt,[(d(),C(x,null,A(F,(a,v)=>m(u(D),{class:"general_list__item operation_list__item operation_list__item--mobile",key:v,onClick:a.handler},{default:R(()=>[s("span",null,te(a.name),1),(d(),$(ye(a.icon)))]),_:2},1032,["onClick"])),64))])]),_:1})]),_:1},8,["modelValue"])):(d(),$(u(je),{key:0,modelValue:O.value,"onUpdate:modelValue":p[0]||(p[0]=a=>O.value=a),onChange:oe},{default:R(()=>[m(u(ce),{title:"Templates",name:"templates"},{default:R(()=>[s("label",St,[s("input",{type:"file",accept:"image/*",onChange:se},null,32),m(u(_))]),s("div",It,[(d(!0),C(x,null,A(V.value.data,(a,v)=>(d(),$(u(D),{class:"general_list__item background_list__item background_list__item--middle",key:v,onClick:I=>ie(a.value)},{default:R(()=>[s("img",{src:a.value},null,8,Rt),Tt]),_:2},1032,["onClick"]))),128))])]),_:1}),m(u(ce),{title:"Avatars",name:"avatars"},{default:R(()=>[s("label",Et,[s("input",{type:"file",accept:"image/*",onChange:le},null,32),m(u(_))]),s("div",Mt,[(d(!0),C(x,null,A(Q.value.data,(a,v)=>(d(),$(u(D),{class:"general_list__item avatar_list__item avatar_list__item--middle",key:v,onClick:I=>re(a.value)},{default:R(()=>[s("img",{src:a.value},null,8,$t),xt,m(u(o))]),_:2},1032,["onClick"]))),128))])]),_:1}),m(u(ce),{title:"Shapes",name:"shapes"},{default:R(()=>[s("div",Lt,[s("div",Pt,[(d(!0),C(x,null,A(U.slice(0,4),(a,v)=>(d(),$(u(D),{class:"general_list__item shape_color_list__item",circle:"",key:v,onClick:I=>M(a),style:ee({backgroundColor:a})},null,8,["onClick","style"]))),128))]),s("div",At,[(d(!0),C(x,null,A(U.slice(4),(a,v)=>(d(),$(u(D),{class:"general_list__item shape_color_list__item",circle:"",key:v,onClick:I=>M(a),style:ee({backgroundColor:a})},null,8,["onClick","style"]))),128))])]),s("div",Ot,[(d(!0),C(x,null,A(u(J),(a,v)=>(d(),$(u(D),{class:"general_list__item shape_list__item shape_list__item--middle",key:v,onClick:I=>r(a.type)},{default:R(()=>[s("img",{src:a.image.value},null,8,Dt),s("span",null,te(a.type.charAt(0).toUpperCase()+a.type.slice(1)),1),m(u(o))]),_:2},1032,["onClick"]))),128))])]),_:1}),m(u(ce),{title:"Operations",name:"operations"},{default:R(()=>[(d(),C(x,null,A(F,(a,v)=>m(u(D),{class:"general_list__item operation_list__item",key:v,onClick:a.handler},{default:R(()=>[s("span",null,te(a.name),1),(d(),$(ye(a.icon)))]),_:2},1032,["onClick"])),64))]),_:1})]),_:1},8,["modelValue"]))]),s("div",{class:"collapse_button",onClick:he},[m(u(i))]),m(dt,{isModalShow:W.value,avatarDataUrl:Z.value,onPassAvatar:pe,onCloseModal:ve},null,8,["isModalShow","avatarDataUrl"])]))}});const Jt=j(Qt,[["__scopeId","data-v-3dd92b3f"]]),zt={id:"stage"},ge="background",fe=10,me=640,ue=40,ea=K({__name:"MyStage",setup(f){class c{constructor(){G(this,"id");this.id=0}get(){return this.id+=1,this.id-1}}const t=Se(),e=T(null),i=T(null),_=T(null),l=T(null),k=T(null),o=new c,g=new c,y=new c,b=new window.Image;let S="",O=null,H=0,W=!1;function Q(r,n){return Math.sqrt(Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2))}function Z(r,n){return{x:(r.x+n.x)/2,y:(r.y+n.y)/2}}function U(){l.value.x(_.value.width()),k.value.x(_.value.width()-fe)}function be(r){const w=e.value.getPointerPosition(),L={x:w.x-e.value.getAbsolutePosition().x,y:w.y-e.value.getAbsolutePosition().y};let E=!0;r.evt.deltaY<0?e.value.scale({x:e.value.scale().x*1.2,y:e.value.scale().y*1.2}):(e.value.scale({x:e.value.scale().x/1.2,y:e.value.scale().y/1.2}),E=!1),e.value.absolutePosition({x:e.value.getAbsolutePosition().x-L.x*((E?1.2:1/1.2)-1),y:e.value.getAbsolutePosition().y-L.y*((E?1.2:1/1.2)-1)}),U()}function J(r){if(W)return;const n=r.evt.touches[0],w=r.evt.touches[1];if(n&&w){e.value.isDragging()&&e.value.stopDrag();const L={x:n.clientX,y:n.clientY},E={x:w.clientX,y:w.clientY},M=Z(L,E),h=Q(L,E);if(!O){O=Z(L,E);return}H===0&&(H=h);const p=e.value.scale().x*(h/H),a=p/e.value.scale().x,v={x:M.x-e.value.getAbsolutePosition().x,y:M.y-e.value.getAbsolutePosition().y};e.value.scale({x:p,y:p});const I={x:M.x-O.x,y:M.y-O.y},N={x:e.value.absolutePosition().x-v.x*(a-1)+I.x,y:e.value.absolutePosition().y-v.y*(a-1)+I.y};e.value.absolutePosition(N),H=h,O=M,U()}}function Y(){H=0,O=null}function z(){e.value.width(document.body.offsetWidth),e.value.height(document.body.offsetHeight)}function F(){const r=_.value.getNode(),n=e.value.findOne(`.${S}`);_.value.moveToTop(),n!==r&&(n?_.value.nodes([n]):_.value.nodes([]),U())}function ae(r){if(r.target===e.value){S="",W=!1,F();return}if(r.target.parent&&r.target.parent.className==="Transformer"){W=!1;return}const n=r.target.name();n===ge?(S="",W=!1):S=n,F()}function V(){const r=e.value.findOne(`.${S}`);r&&(r.destroy(),_.value.nodes([]))}function he(r){b.src=r,i.value.draw()}function oe(r){const n=r.evt.touches[0],w=r.evt.touches[1];n&&w&&(W=!0,e.value.isDragging()&&e.value.stopDrag())}function ne(){W=!1}function se(r){const n=new window.Image;n.src=r;const w=new P.Circle({x:(b.width-n.width)/2,y:(b.height-n.height)/2,radius:n.width/2,fillPatternImage:n,fillPatternRepeat:"no-repeat",fillPatternOffsetX:n.width/2,fillPatternOffsetY:n.height/2,draggable:!0,name:`avatar_${o.get()}`,offsetX:-n.width/2,offsetY:-n.height/2});w.on("touchmove",oe),w.on("touchend",ne),i.value.add(w),S=w.name(),F()}function le(){let n=Ie(t.shape_node.type,t.shape_node.color,100,`shape_${g.get()}`);n&&(n.position({x:b.width/2-100,y:b.height/2-100}),n.on("touchmove",oe),n.on("touchend",ne),i.value.add(n),S=n.name(),F())}function pe(){const r=e.value.clone(),n=r.getLayers()[0],w=r.findOne("Transformer"),L=document.createElement("a");let E=0,M=0,h=0,p=0;r.scale({x:1,y:1}),w==null||w.destroy();for(let a=0;a<n.children.length;a+=1){const v=n.children[a].absolutePosition().x,I=n.children[a].absolutePosition().y,N=n.children[a].absolutePosition().x+n.children[a].width(),we=n.children[a].absolutePosition().y+n.children[a].height();a===0?(E=v,M=I,h=N,p=we):(E=Math.min(E,v),M=Math.min(M,I),h=Math.max(h,N),p=Math.max(p,we))}L.download=`berserk${"7".repeat(y.get()+1)}meta.png`,L.href=r.toDataURL({x:E,y:M,width:h-E,height:p-M}),document.body.appendChild(L),L.click(),document.body.removeChild(L)}function ve(){var r;e.value.position({x:document.body.clientWidth>me?(((r=document.querySelector(".aside"))==null?void 0:r.offsetWidth)??0)+ue:0,y:document.body.clientWidth>me?ue:0}),e.value.scale({x:1,y:1})}function ie(r){if(S==="")return;const n=e.value.findOne(`.${S}`);if(n)if(r)n.moveToTop();else{const w=e.value.findOne(`.${ge}`);w&&(n.moveToBottom(),w.moveToBottom())}F()}function re(r){if(S===""||S.includes("avatar")||r==="")return;const n=e.value.findOne(`.${S}`);n&&n.setAttr("fill",r)}return X(()=>{var w;const n="#E76161";P.hitOnDragEnabled=!0,e.value=new P.Stage({container:"stage",width:document.body.offsetWidth,height:document.body.offsetHeight,draggable:!0}),i.value=new P.Layer,_.value=new P.Transformer({centeredScaling:!0,keepRatio:!0}),l.value=new P.Circle({y:-50,radius:fe,stroke:n,fill:"white",strokeWidth:1}),k.value=new P.Line({y:-50,points:[0,0,fe*2,0],stroke:n,strokeWidth:1+1}),document.body.offsetWidth>me&&(e.value.x((((w=document.querySelector(".aside"))==null?void 0:w.offsetWidth)??0)+ue),e.value.y(ue)),e.value.on("wheel",be),e.value.on("touchmove",J),e.value.on("touchend",Y),e.value.on("mousedown",ae),e.value.on("touchstart",ae),_.value.on("transform",()=>{U()}),l.value.on("mouseenter",()=>{e.value.container().style.cursor="pointer"}),l.value.on("mouseleave",()=>{e.value.container().style.cursor="default"}),l.value.on("click",V),l.value.on("touchend",V),k.value.on("mouseenter",()=>{e.value.container().style.cursor="pointer"}),k.value.on("mouseleave",()=>{e.value.container().style.cursor="default"}),k.value.on("click",V),k.value.on("touchend",V),_.value.add(l.value),_.value.add(k.value),i.value.add(new P.Image({image:b,name:ge})),i.value.add(_.value),e.value.add(i.value),window.addEventListener("resize",z)}),st(()=>{window.removeEventListener("resize",z)}),B(()=>t.avatar_node,()=>{t.avatar_node&&t.avatar_node!==""&&(se(t.avatar_node),t.avatar_node="")}),B(()=>t.is_trigger_add_shape_node,()=>{t.is_trigger_add_shape_node&&(le(),t.is_trigger_add_shape_node=!1)}),B(()=>t.background_node,()=>{t.background_node&&t.background_node!==""&&(he(t.background_node),t.background_node="")}),B(()=>t.is_trigger_save_image,()=>{t.is_trigger_save_image&&(pe(),t.is_trigger_save_image=!1)}),B(()=>t.is_trigger_relocate,()=>{t.is_trigger_relocate&&(ve(),t.is_trigger_relocate=!1)}),B(()=>t.is_trigger_change_z_index,()=>{t.is_trigger_change_z_index&&(ie(t.is_to_top),t.is_trigger_change_z_index=!1)}),B(()=>t.is_trigger_change_color,()=>{t.is_trigger_change_color&&(re(t.changed_color),t.is_trigger_change_color=!1)}),(r,n)=>(d(),C("div",zt))}});const ta=j(ea,[["__scopeId","data-v-54b3565e"]]),q=f=>(Ce("data-v-afec8304"),f=f(),ke(),f),aa={class:"app__container"},oa={key:0,className:"loading_spinner"},na=q(()=>s("div",null,null,-1)),sa=q(()=>s("div",null,null,-1)),la=q(()=>s("div",null,null,-1)),ia=q(()=>s("div",null,null,-1)),ra=q(()=>s("div",null,null,-1)),ca=q(()=>s("div",null,null,-1)),_a=q(()=>s("div",null,null,-1)),ua=q(()=>s("div",null,null,-1)),da=[na,sa,la,ia,ra,ca,_a,ua],ha=K({__name:"App",setup(f){const c=T(!0);async function t(e){const i=e.map(_=>new Promise((l,k)=>{const o=new Image;o.src=_,o.onload=l,o.onerror=k}));await Promise.all(i),c.value=!1}return X(()=>{document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`),window.addEventListener("resize",()=>{document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`)}),window.addEventListener("touchmove",e=>{const i=e.touches[0],_=e.touches[1];i&&_&&e.preventDefault()},{passive:!1}),t([Re,Te,Ee,Me,$e,xe,Le]).catch(console.error)}),(e,i)=>(d(),C("div",aa,[c.value?(d(),C("div",oa,da)):(d(),C(x,{key:1},[s("aside",null,[m(Jt)]),s("main",null,[m(ta)])],64))]))}});const pa=j(ha,[["__scopeId","data-v-afec8304"]]);const va=lt();it(pa).use(va).mount("#app");
